腿足机器人领域拥有悠久的研究历史，然而，由于电机、减速器、结构、传感器等硬件技术的限制以及控制算法的滞后，足式机器人在几十年的发展中一直局限于高校等研究机构的实验室。

在过去的十年中，随着硬件技术的进步和人工智能的崛起，腿足机器人逐渐摆脱实验室的束缚，开始融入人们的日常生活。美国Boston Dynamics的Spot、瑞士ANYbotics的ANYmal机器人，以及国内的宇树、云深处等公司纷纷推出了自己的四足机器人产品。同时，新兴汽车企业如特斯拉、小鹏等也开始关注通用人形机器人，计划将其应用于汽车生产线，取代传统的工业机器人和大量人工劳动力。

”

小米作为一家高科技公司，一直致力于为用户提供最酷的产品。在2021年小米便发布了其首款仿生四足机器人——CyberDog，大家会亲切地称为“铁蛋”，今年8月14日雷总年度演讲上发布了全新的CyberDog 2。

CyberDog 2经过两年的精心研发，工程师们充分吸纳了用户的宝贵反馈，结合小米在运动控制和人工智能领域的技术创新和积累，不仅在外观上更具仿生特性，用户互动也更加友好。同时，它在运动性能方面也有了显著的提升，引入AI强化学习并行训练三万条狗，解锁更多“狗”的动作。接下来，一起深入了解一下这款更“狗”的CyberDog 2机器人。

01
身材小巧依旧灵活
新一代的狗子轻巧了不少，但关节电机还是非常强劲，再有先进的运动控制算法加持，CyberDog 2可以实现非常灵活敏捷的运动。

▍快速奔跑


CyberDog 2快速奔跑

CyberDog 2在运动过程中，通常会基于一个简化的模型来根据当前的自身状态和环境信息预测未来的变化，从而决定腿部的发力和身体躯干的运动，这个过程我们称之为模型预测控制。由于模型预测控制只采用了简化的模型，所以在它之后经常会用更细致的完整全身动力学模型来优化各个关节的力矩，实现对模型预测控制给出的运动轨迹的跟随。具体的运动控制框架如下图所示：



除了前面提到的模型预测控制和全身运动控制，机器人的运动学、动力学模型，状态估计等也在其中发挥了重要的作用。利用这些方法，CyberDog 2可以实现快速的奔跑同时在复杂的地形下保持稳定。

作为一只爱好运动的狗子，户外的地形在CyberDog 2这也不是问题：



CyberDog 2在复杂地形稳定运动

同时，CyberDog 2还很灵活，在受到外部扰动时，能够很好地保持平衡：



CyberDog 2受到外部干扰时保持平衡

▍轻松后翻
我们的CyberDog 2机器人虽然身形更加小巧，但是运动性能一点也没有缩水，甚至超过很多比他体型更大的同行伙伴。相比于第一代CyberDog的后空翻，新CyberDog 2可以实现三连罗汉翻，这都要得益于小米自研的高性能微电机和优秀的运动控制算法。



CyberDog 2三连罗汉翻

微电机方面，CyberGear单个电机力矩精度相比上一代提升50%，而且峰值扭矩密度达到了37.85Nm/kg的业界领先水平，搭配小米自研的电机控制算法，可以满足各种条件的需要。运动控制算法方面，在学术界开源算法的基础上，小米自研了针对高动态动作的的轨迹优化方法，只需要给出初始状态和结束状态，算法就可以智能地计算出机器人完整的运动过程，并且最大限度地发挥所有关节的能力。

轨迹优化指的是在满足某些约束的情况下，通过最小化代价函数，来设计一条轨迹的过程。用数学可以表示为如下形式，其中min中的部分就是代价函数，subject to中的内容就是约束，求解这个问题之后，就可以得到状态x和控制输入u随时间变化的轨迹。

 Subject to

轨迹优化的算法已经有将近100年的历史，但是由于其庞大的计算量，在计算机技术面世之后轨迹优化才被应用到实际中。最早使用轨迹优化的是航天航空和军事领域，例如SpaceX计算回收火箭下落的轨迹，就是一个典型的轨迹优化问题。相比于火箭回收，机器人的轨迹优化问题的难度来源于其动力学的高维度和强非线性，机器人的动力学方程如下，

这个公式对应的就是轨迹优化中动力学约束  ,其中  是18维向量，是机器人广义自由度，代表机器人包括浮动基在内的18个自由度，其中浮动基6个自由度，表示躯干可以在空间中任意运动，12个主动自由度对应。  是18*18维的矩阵，表示机器人动力学惯量矩阵。  是18维向量，包含向心力、重力和科里奥利力分量。  是12*18维矩阵，代表足底力的雅克比矩阵。  是12维向量，表示所有足底产生的支撑力。  是18维向量，包括6维浮动基力和力矩，以及12个关节的力矩，由于浮动基为被动自由度，所以  前6维为零。

可以发现，这个问题的维度非常大，而且上面的矩阵中充满了三角函数等非线性项，通过小米自研的高动态动作的的轨迹优化方法，CyberDog 2可以准确、快速并高效地求解这个问题，从而完成各种高难度的动作。

02
第一个会滑滑板的机器人

滑板的需求起源于我们工程师团队中的滑板爱好者。既然真正的狗狗可以玩滑板，那为什么不能让机器人也来一场滑板秀呢？为了解决这个有趣的问题，工程师们展开了一番深入的研究。他们观看了世界上最先进的机器人视频，翻阅了近十几年的文献资料，但却惊讶地发现，从来没有腿足机器人具备滑滑板的能力。

然而，工程师们并没有被困难吓倒。他们毫不畏惧地开始了从零开始的探索，无法找到合适的方法就亲自推导数学公式，找不到合适的滑板就不厌其烦地搜索每一个滑板链接，没有场地就趁着没有人的时候躲进地下室进行实验。最终，他们成功地教会了CyberDog 2如何玩滑板，甚至完成了滑板后空翻这个惊艳的动作。这不仅是实现了真狗的技能，更是超越了它们，得到了广大米粉和机器人爱好者的一致好评。

放眼全世界，CyberDog 2也是第一个掌握这项技能的机器人，这也体现了小米多年来在机器人运动控制领域的积累。



CyberDog 2空翻下滑板

03
AI训练三万只，解锁更“狗”的动作
CyberDog 2不小心摔倒了怎么办？如何让CyberDog 2又快又“狗”地从地上爬起来？

▍摔倒起身


基于AI强化学习的摔倒起身

摔倒起身这一过程，听起来似乎是很简单的一件事，但由于复杂且未知的接触和碰撞动力学，使用传统的轨迹优化就有些力不从心。使用强化学习的控制策略就可以很好地弥补这一点，我们可以利用已有的仿真器进行大量并行的模拟，学习一种策略来将机器人的当前和过去的观测映射成机器人的动作，而无需对机器狗和地面的接触碰撞进行数学建模。

在强化学习中，机器人与环境的交互过程可以看做一个马尔科夫链决策过程(MDP)，机器人观测到的环境状态记为  ，执行动作为  ，机器人的决策策略记为  ，代表一种  和  之间的映射，  表示这是用神经网络拟合的策略。每次观测到  后机器人根据策略输出执行  并与环境交互，得到奖励  。我们的目标就是就是通过一次次的模拟仿真，收集机器人的观测，动作和奖励组成的轨迹  数据，利用这些数据来优化我们的策略  。轨迹中所有奖励  组成的累积回报记为  ，因此我们的目标就是找到能使我们的期望累积回报最大化的  ，即  这是一个优化问题，因此我们可以利用梯度上升的方式来更新  ，  。根据概率论公式，得到这样一条轨迹的概率为 两边求梯度并取log可得最终期望累积回报的梯度：

这就是强化学习中策略梯度的表达形式，期望可以使用蒙特卡洛采样近似，有了这个式子我们就可以不断地在仿真中收集数据更新我们的策略了。由于在仿真器中，机器狗已经学习过成千上万种不同情况下起身的方法，因此面对现实中的各种意外跌倒也能从容应对。



小米AI强化学习平台训练30000条狗

▍高动态动作
除了意外倒地起身，在一些高动态的情况下，基于强化学习的方法也展现出超过传统优化控制器的能力，可以充分挖掘硬件的潜力，增强了CyberDog 2的动态性能，让CyberDog 2更“狗”了。



基于AI强化学习的转圈圈



基于AI强化学习的蹦蹦跳跳



基于AI强化学习的侧空翻


04
直观友好的人狗交互

基于灵敏的本体感知控制器和自身所携带的多传感器，CyberDog 2可以与主人进行直观友好的交互。它的全身运动控制器，可以自主感知施加在机体上的外部牵引力，让主人体验到几乎真实的“遛狗”。



CyberDog 2真实的“遛狗”体验

它的关节控制器，可以精确地控制关节力矩，碰到障碍物时可以快速作出反应，甚至是“豆腐”这种软软的物体。



CyberDog 2精准控制力矩触碰豆腐

它还装备了TOF、触摸等多种传感器，可以接受多种外部信息，比如摸一下脑袋可以语音播报剩余电量，摸一下下巴会做出“撒娇”的动作。



CyberDog 2“撒娇”

-

小米深知，机器人不仅仅是冷冰冰的机械构造，更是情感与智慧的结合。小米不仅在机器人的外表上追求精湛的工艺，更加致力于赋予机器人以人性化的情感和智能。小米相信，机器人不仅可以成为人类生活的助手，更可以成为人类情感的陪伴。同时，仿生机器人的研发，是全球共创的浩瀚工程，这个领域需要更多人的一起探索。小米也愿意为此作出贡献，加快推进这个行业进步。所以小米将CyberDog 2开源，希望更多人加入共创，共同推动机器人行业的进步。

小米的机器人团队充满激情和创意，他们致力于创造能够与人类产生共鸣的机器人。无论是可爱的陪伴型机器人，还是功能强大的助力型机器人，小米都希求在技术的基础上融入人性化的情感，让机器人不再是冷漠的工具，而是温暖的朋友。

[1]: https://blog.csdn.net/pengzhouzhou/article/details/133723028?spm=1001.2014.3001.5502
