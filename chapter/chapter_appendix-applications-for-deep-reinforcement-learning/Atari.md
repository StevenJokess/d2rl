#

# Atari

基本内容在[Game](Game.md)已经介绍过了，[DQN](../chapter_DQN-algs)也讲过了，下面介绍如何利用DQN解决Atari。

## 伪代码

![DQN](../../img/DQN_atari.png)

直接处理原始 Atari 帧，即 $210 \times 160$ 像素图像和 128 色，在计算上要求很高，因此作者应用 了一个旨在降低输入维度的基本预处理步骤。对原始帧进行预处理通过首先将其 RGB 表示转换为 灰度并将其下采样为 $110 \times 84$ 图像。最终的输入表示是通过裁剪图像的 $84 \times 84$ 区域来获得 的，该区域粗略地捕获了播放区域。最后的裁剪阶段之所以需要是因为作者使用了中 $2 D$ 卷积的 GPU 实现，它需要方形输入。对于本文中的实验，算法 1 中的函数 $\phi$ 将此预处理应用于历史的最后 4 帧，并将它们堆叠起来以生成 $Q$ 函数的输入。

有几种使用神经网络参数化 $Q$ 的可能方法。由于 $Q$ 将历史-动作对（ history-action pairs）映射到其 $Q$ 值的估计， 因此历史和动作已被某些先前的方法用作神经网络的输入。这种架构的主要缺 点是需要单独的前向传播来计算每个动作的 $Q$ 值，导致成本与动作数量成线性比例。作者改为使 用一种架构，其中每个可能的动作都有一个单独的输出单元，只有状态表示是神经网络的输入。输出对应于输入状态的单个动作的预测 $Q$ 值。这种架构的主要优点是能够计算给定状态下所有可能动作的 $\mathrm{Q}$ 值，只需通过网络进行一次前向传递。

作者现在描述用于所有七款 Atari 游戏的具体架构。神经网络的输入是由 $\phi$ 生成的 $84 \times 84 \times 4$ 图像。第一个隐藏层将 16 个步长为 4 的 $8 \times 8$ 滤波器与输入图像进行卷积，并应用激活函数。 第二个隐藏层卷积 32 个 $4 \times 4$ 的滤波器，步长为 2 ，再次跟随激活函数。最后的隐藏层是全连接层，由 256 个神经元组成。输出层是一个全连接层，每个有效动作都有一个输出。在作者考虑的游戏中，有效动作的数量在 4 到 18 之间。作者将使用该方法训练的卷积网络称为 Deep Q Networks (DQN)。

[1]: https://zhuanlan.zhihu.com/p/441314394?utm_campaign=&utm_medium=social&utm_oi=772887009306906624&utm_psn=1628228840898924544&utm_source=qq
